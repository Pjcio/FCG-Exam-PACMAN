#include "TileMap.h"

TileMap::TileMap() {
    grid = {
        {2, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 40, 39, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 1},
        {4, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 22, 21, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 3},
        {4, 41, 36, 19, 19, 35, 41, 36, 19, 19, 19, 35, 41, 22, 21, 41, 36, 19, 19, 19, 35, 41, 36, 19, 19, 35, 41, 3},
        {4, 43, 22, 41, 41, 21, 41, 22, 41, 41, 41, 21, 41, 22, 21, 41, 22, 41, 41, 41, 21, 41, 22, 41, 41, 21, 43, 3},
        {4, 41, 38, 20, 20, 37, 41, 38, 20, 20, 20, 37, 41, 38, 37, 41, 38, 20, 20, 20, 37, 41, 38, 20, 20, 37, 41, 3},
        {4, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 3},
        {4, 41, 36, 19, 19, 35, 41, 36, 35, 41, 36, 19, 19, 19, 19, 19, 19, 35, 41, 36, 35, 41, 36, 19, 19, 35, 41, 3},
        {4, 41, 38, 20, 20, 37, 41, 22, 21, 41, 38, 20, 20, 32, 31, 20, 20, 37, 41, 22, 21, 41, 38, 20, 20, 37, 41, 3},
        {4, 41, 41, 41, 41, 41, 41, 22, 21, 41, 41, 41, 41, 22, 21, 41, 41, 41, 41, 22, 21, 41, 41, 41, 41, 41, 41, 3},
        {6, 12, 12, 12, 12, 35, 41, 22, 33, 19, 19, 35,   0, 22, 21,  0, 36, 19, 19, 34, 21, 41, 36, 12, 12, 12, 12, 5},
        {0,  0,  0,  0,  0,  4,  0, 22, 31, 20, 20, 37,  0, 38, 37,  0, 38, 20, 20, 32, 21,  0,  3,  0,  0,  0,  0,  0},
        {0,  0,  0,  0,  0,  4,  0, 22, 21,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 22, 21,  0,  3,  0,  0,  0,  0,  0},
        {0,  0,  0,  0,  0,  4,  0, 22, 21,  0, 26, 12, 30,  0,  0, 29, 12, 25,  0, 22, 21,  0,  3,  0,  0,  0,  0,  0},
        {11, 11, 11, 11, 11, 37,  0, 38, 37,  0,  3,  0,  0,  0,  0,  0,  0,  4,  0, 38, 37,  0, 38, 11, 11, 11, 11, 11},
        {0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  3,  0,  0,  0,  0,  0,  0,  4,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0},
        {12, 12, 12, 12, 12, 35,  0, 36, 35,  0,  3,  0,  0,  0,  0,  0,  0,  4,  0, 36, 35,  0, 36, 12, 12, 12, 12, 12},
        {0,  0,  0,  0,  0,  4,  0, 22, 21,  0, 28, 11, 11, 11, 11, 11, 11, 27,  0, 22, 21,  0,  3,  0,  0,  0,  0,  0},
        {0,  0,  0,  0,  0,  4,  0, 22, 21,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 22, 21,  0,  3,  0,  0,  0,  0,  0},
        {0,  0,  0,  0,  0,  4,  0, 22, 21,  0, 36, 19, 19, 19, 19, 19, 19, 35,  0, 22, 21,  0,  3,  0,  0,  0,  0,  0},
        {2, 11, 11, 11, 11, 37,  0, 38, 37,  0, 38, 20, 20, 32, 31, 20, 20, 37,  0, 38, 37,  0, 38, 11, 11, 11, 11,  1},
        {4, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 22, 21, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 3},  
        {4, 41, 36, 19, 19, 35, 41, 36, 19, 19, 19, 35, 41, 22, 21, 41, 36, 19, 19, 19, 35, 41, 36, 19, 19, 35, 41, 3},  
        {4, 41, 38, 20, 32, 21, 41, 38, 20, 20, 20, 37, 41, 38, 37, 41, 38, 20, 20, 20, 37, 41, 22, 31, 20, 37, 41, 3},  
        {4, 43, 41, 41, 22, 21, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 22, 21, 41, 41, 43, 3},  
        {8, 19, 35, 41, 22, 21, 41, 36, 35, 41, 36, 19, 19, 19, 19, 19, 19, 35, 41, 36, 35, 41, 22, 21, 41, 36, 19, 7},  
        {10, 20, 37, 41, 38, 37, 41, 22, 21, 41, 38, 20, 20, 32, 31, 20, 20, 37, 41, 22, 21, 41, 38, 37, 41, 38, 20, 9},  
        {4, 41, 41, 41, 41, 41, 41, 22, 21, 41, 41, 41, 41, 22, 21, 41, 41, 41, 41, 22, 21, 41, 41, 41, 41, 41, 41, 3},  
        {4, 41, 36, 19, 19, 19, 19, 34, 33, 19, 19, 35, 41, 22, 21, 41, 36, 19, 19, 34, 33, 19, 19, 19, 19, 35, 41, 3},  
        {4, 41, 38, 20, 20, 20, 20, 20, 20, 20, 37, 1, 41, 38, 37, 41, 38, 20, 20, 20, 20, 20, 20, 20, 20, 37, 41, 3},  
        {4, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 3},  
        {6, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 5}  

    };
    tileSize = 8 * 4;
    textures = loadAssetsMapFromDirectory("resources/tiles"); 

    for (size_t y = 0; y < grid.size(); ++y) {
        for (size_t x = 0; x < grid[y].size(); ++x) {
            int tileId = grid[y][x];
            if (textures.find(tileId) != textures.end()) {
                sf::Sprite sprite(textures.at(tileId));
                sprite.setPosition(sf::Vector2f(static_cast<float>(x * tileSize), static_cast<float>(y * tileSize)));
                sprite.setScale(sf::Vector2f(4.0f, 4.0f)); 

                sprites.push_back(sprite);
            }
        }
    }
}

void TileMap::draw(sf::RenderWindow& window) const {
    // Disegna tutti gli sprite in un'unica chiamata
    for (const auto& sprite : sprites) {
        window.draw(sprite);
    }
}
